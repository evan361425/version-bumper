{
  "title": "Bumper JSON configuration",
  "$schema": "http://json-schema.org/draft-04/schema#",

  "properties": {
    "debug": {
      "type": "boolean",
      "default": false,
      "title": "執行程式而不會有任何副作用",
      "description": "同時會輸出一些雜七雜八的日誌到 stdout"
    },
    "repoLink": {
      "type": "string",
      "title": "Changelog 中會作為 tag 的連結",
      "description": "預設使用 `git remote get-url origin` 的輸出，\n若無則為 `https://github.com/example/example`"
    },
    "prRepo": {
      "type": "string",
      "title": "要開 PR 的 Repo",
      "description": "預設是用 `repoLink` 得值，\n例如：`example/example`"
    },
    "commitMessage": {
      "type": "string",
      "default": "chore: bump to <version>",
      "title": "每次升版的 commit 訊息",
      "description": "支援的變數有：\n`version`、`ticket`、`stage`"
    },
    "baseBranch": {
      "type": "string",
      "default": "main",
      "title": "主分支的名稱",
      "description": "通常是 `master` 或 `main`"
    },
    "prodOtherPr": {
      "type": "string",
      "title": "線上可能會需要開兩個 PR",
      "description": "這是為了 DR 環境而設計的"
    },
    "prOnly": {
      "type": "boolean",
      "default": false,
      "title": "根據設定只建立 PR 而不做任何升版",
      "description": "通常需要重新建立 PR 的時候會用到"
    },
    "productionName": {
      "type": "string",
      "default": "production",
      "title": "線上的分支名稱",
      "description": "這會用來判斷是否為線上，若為線上則會去改 Changelog"
    },
    "changelog": {
      "type": "object",
      "additionalProperties": false,
      "title": "針對 Changelog 的設定",
      "properties": {
        "disable": {
          "cliName": "changelogDisable",
          "type": "boolean",
          "default": false,
          "title": "不對 Changelog 做任何事"
        },
        "ticketPrefix": {
          "cliName": "changelogTicketPrefix",
          "type": "string",
          "default": "票號：",
          "title": "在 Changelog 中票號的前綴詞",
          "description": "如果有給票號，\n在 Changelog 中每個版本的資訊中都會有票的訊息，\n這就是其的前綴。"
        },
        "header": {
          "cliName": "changelogHeader",
          "type": "string",
          "default": "# Changelog\n\n所有本專案的版本紀錄將於此說明之\n\n文件依照 [Keep a Changelog](https://keepachangelog.com/en/1.0.0/) 內所描述的格式撰寫，版本號碼依照 [Semantic Versioning](https://semver.org/spec/v2.0.0.html)。",
          "title": "Changelog 的標題",
          "description": "在這之後就是 unreleased 的資訊。"
        }
      }
    },
    "files": {
      "type": "object",
      "additionalProperties": false,
      "title": "相關文件的位置",
      "properties": {
        "changelog": {
          "cliName": "fileChangelog",
          "type": "string",
          "default": "CHANGELOG.md",
          "title": "Changelog 位置"
        },
        "latestVersion": {
          "cliName": "fileLatestVersion",
          "type": "string",
          "default": "docs/LATEST_VERSION.md",
          "title": "最新版本的內文位置",
          "description": "其中的票號會被 `autoLinks` 自動補上連結。\n支援的 metadata 有：<version>、<ticket>"
        },
        "prTemplate": {
          "cliName": "filePrTemplate",
          "type": "string",
          "default": "docs/PR_TEMPLATE.md",
          "title": "PR 文本的位置",
          "description": "支援的變數有：\n<ticket>、<stage>、<version>、最新版本的內文<content>、連結<diff>"
        }
      }
    },
    "latestVersion": {
      "type": "string",
      "title": "最新版本號",
      "description": "不建議設定於此，\n請在 `files.latestVersion` 中透過 metadata 注入。"
    },
    "latestTicket": {
      "type": "string",
      "title": "最新票號",
      "description": "不建議設定於此，\n請在 `files.latestVersion` 中透過 metadata 注入。"
    },
    "latestContent": {
      "type": "string",
      "title": "最新版本的內文",
      "description": "不建議設定於此，\n請寫在 `files.latestVersion`。"
    },
    "autoLinks": {
      "type": "object",
      "additionalProperties": false,
      "description": "用來對票號自動補上連結",
      "patternProperties": {
        "^[a-zA-Z-]+$": {
          "type": "string",
          "title": "票號前綴對上連結模板",
          "description": "只支援 a-z, A-Z 和 - 作為鍵，\n支援變數：\n<num> 來用做票號。例如 `TICKET-`（不分大小寫）對上 `https://example/ticket-<num>?k=v`，\n就會把 tIcKet-123 轉成 https://example/tIcKet-123?k=v"
        }
      },
      "cli": {
        "autoLinkKeys": {
          "title": "票號前綴",
          "description": "以逗號（,）做為區隔，每個值只支援 a-z, A-Z 和 -"
        },
        "autoLinkValues": {
          "title": "連結模板",
          "description": "以逗號（,）做為區隔，\n照順序對應 `autoLinkKeys`，\n支援變數：\n<num> 來用做票號"
        }
      }
    },
    "branches": {
      "type": "object",
      "description": "用來作為 PR 的分支設定",
      "patternProperties": {
        "^[a-zA-Z\\-_]$": {
          "type": "object",
          "additionalProperties": false,
          "description": "鍵值只是代表名稱",
          "properties": {
            "base": {
              "type": "string",
              "title": "做 PR 時的來源分支",
              "default": "透過 `baseBranch` 取得",
              "description": "需要為 git 上的名稱，\n例如 `production` 的 base 可能為 `deploy/staging`"
            },
            "head": {
              "type": "string",
              "title": "做 PR 時的目標分支",
              "default": "deploy/<name>",
              "description": "需要為 git 上的名稱，\n例如 `production` 的 head 可能為 `deploy/production`"
            },
            "reviewers": {
              "type": "array",
              "uniqueItems": true,
              "items": { "type": "string" },
              "title": "發 PR 時的 reviewers",
              "description": "不可以重複"
            },
            "versionPattern": {
              "type": "string",
              "title": "確認目前的版本是否為這個分支",
              "description": "會使用 `latestVersion` 來最為版本資訊，\n例如 staging 環境的標籤模式可能為 `v\\d+.\\d+.\\d+-rc\\d*`"
            },
            "labels": {
              "type": "array",
              "uniqueItems": true,
              "items": { "type": "string" },
              "title": "發 PR 時的 labels",
              "description": "不可以重複"
            }
          }
        }
      },
      "default": {
        "staging": { "base": "deploy/develop", "head": "deploy/staging" },
        "production": { "base": "deploy/staging", "head": "deploy/production" }
      },
      "cli": {
        "branchNames": {
          "title": "分支名稱",
          "default": "staging,production",
          "description": "以逗號（,）做為區隔"
        },
        "branchBases": {
          "title": "做 PR 時的來源分支",
          "default": "deploy/develop,deploy/staging",
          "description": "以逗號（,）做為區隔，否則為 `baseBranch`"
        },
        "branchHeads": {
          "title": "做 PR 時的目標分支",
          "default": "deploy/<name>",
          "description": "以逗號（,）做為區隔"
        },
        "branchReviewers": {
          "title": "做 PR 時的 reviewers",
          "description": "以逗號（,）做為區隔不同分支，\n再以斜線（/）區分不同 reviewer，\n例如 `stag-rev,prod-rev1/prod-rev2`"
        },
        "branchPatterns": {
          "title": "該分支的版本模式",
          "description": "以逗號（,）做為區隔，\n例如 `^v\\d+.\\d+.\\d+-rc\\d*$,^v\\d+.\\d+.\\d+$`"
        },
        "branchLabels": {
          "title": "做 PR 時的 labels",
          "description": "以逗號（,）做為區隔不同分支，\n再以空白（ ）區分不同 label，\n例如 `stag-label,prod-label1 prod-label2`"
        }
      }
    }
  }
}
